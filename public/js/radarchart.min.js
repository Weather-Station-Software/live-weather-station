function RadarChart(){var g=UUID.generate();var F=[];var n={filter:"rcGlow"+g,filter_id:"rcGlow"+g,resize:false,valFormat:"",valUnit:"",width:window.innerWidth,widthMax:window.innerWidth,height:window.innerHeight,heightMax:window.innerHeight,correctAdd:0,correctMul:1,minRadius:80,margins:{top:0,right:0,bottom:0,left:0},circles:{levels:6,maxValue:0,labelFactor:1.25,opacity:0.1,fill:"#CDCDCD",color:"#CDCDCD"},areas:{colors:{},opacity:0.35,borderWidth:2,rounded:false,dotRadius:4,sort:true,filter:[]},axes:{display:true,threshold:90,lineColor:"white",lineWidth:"2px",fontWidth:"11px",fontColor:"black",wrapWidth:60,filter:[],invert:[],ranges:{}},classed:"lws",color:d3.scale.category10().range()};var i;var z;var x;var o={update:{begin:null,end:null},gridCircle:{mouseover:null,mouseout:null,mouseclick:null},axisLabel:{mouseover:null,mouseout:null,mouseclick:null},line:{mouseover:null,mouseout:null,mouseclick:null},legend:{mouseover:k,mouseout:v,mouseclick:j},axisLegend:{mouseover:null,mouseout:null,mouseclick:null},radarArea:{mouseover:D,mouseout:v,mouseclick:null},radarInvisibleCircle:{mouseover:C,mouseout:a,mouseclick:null}};var r;var t;var G=[];var c=[];var B={};var b=d3.format(n.valFormat);var E=0;var s=0;var p;var m;var w;var d;function H(M){M.each(function(){L();h();d=d3.select(this);u();var N=d.append("svg").attr("overflow","visible").attr("width",n.width).attr("height",n.height);i=N.append("g").attr("class",n.classed+"RadarNode");z=N.append("g").attr("class",n.classed+"HoverNode");x=N.append("foreignObject").attr("class",n.classed+"TooltipNode");var T=i.append("g").attr("class",n.classed+"AxisWrapper");var P=i.append("defs").append("filter").attr("id",n.filter_id),S=P.append("feGaussianBlur").attr("stdDeviation","2.5").attr("result","coloredBlur"),R=P.append("feMerge"),Q=R.append("feMergeNode").attr("in","coloredBlur"),O=R.append("feMergeNode").attr("in","SourceGraphic");t=x.append("xhtml:div").style("opacity","0").style("text-align","left").style("float","left");r=function(){var W=E;b=d3.format(n.valFormat);L();h();p=G.map(function(af){return af.key});m=d3.scale.ordinal().domain(G.map(function(af){return af._i})).range(G.map(function(af){return af.key}));w=d3.scale.ordinal().domain(G.map(function(af){return n.areas.colors[m(af._i)]?m(af._i):af._i.toString()})).range(G.map(function(af){return l(af)}));N.transition().delay(s).duration(W).attr("width",n.width).attr("height",n.height);i.transition().delay(s).duration(W).attr("width",n.width).attr("height",n.height).attr("transform","translate("+((n.width-(n.margins.left+n.margins.right))/2+n.margins.left)+","+((n.height-(n.margins.top+n.margins.bottom))/2+n.margins.top)+")");z.transition().delay(s).duration(W).attr("width",n.width).attr("height",n.height).attr("transform","translate("+((n.width-(n.margins.left+n.margins.right))/2+n.margins.left)+","+((n.height-(n.margins.top+n.margins.bottom))/2+n.margins.top)+")");x.transition().delay(s).duration(W).attr("width",n.width/2).attr("height",n.height/4).attr("transform","translate("+(10-n.margins.top)+",0)");t.transition().delay(s).duration(W).attr("width",n.width/2).attr("height",n.height/4);var ab=T.selectAll("."+n.classed+"GridCircle").data(d3.range(1,(n.circles.levels+1)).reverse());ab.transition().duration(W).attr("r",function(ag,af){return B.radius/n.circles.levels*ag}).style("fill",n.circles.fill).style("fill-opacity",n.circles.opacity).style("stroke",n.circles.color).style("filter",function(){if(n.filter){return"url(#"+n.filter+")"}});ab.enter().append("circle").attr("class",n.classed+"GridCircle").attr("r",function(ag,af){return B.radius/n.circles.levels*ag}).on("mouseover",function(ag,af){if(o.gridCircle.mouseover){o.gridCircle.mouseover(ag,af)}}).on("mouseout",function(ag,af){if(o.gridCircle.mouseout){o.gridCircle.mouseout(ag,af)}}).style("fill",n.circles.fill).style("fill-opacity",n.circles.opacity).style("stroke",n.circles.color).style("filter",function(){if(n.filter){return"url(#"+n.filter+")"}});ab.exit().transition().duration(W*0.5).delay(function(ag,af){return 0}).remove();var Z=T.selectAll("."+n.classed+"AxisLabel").data(d3.range(1,(n.circles.levels+1)).reverse());Z.transition().duration(W/2).style("opacity",1).transition().duration(W/2).text(function(ag,af){if(B.maxValue){return b(n.correctAdd+(n.correctMul*B.maxValue*ag/n.circles.levels))+n.valUnit}}).attr("y",function(af){return -af*B.radius/n.circles.levels}).style("opacity",1);Z.enter().append("text").attr("class",n.classed+"AxisLabel").attr("x",4).attr("y",function(af){return -af*B.radius/n.circles.levels}).attr("dy","0.4em").style("font-size","10px").attr("fill","#737373").on("mouseover",function(ag,af){if(o.axisLabel.mouseover){o.axisLabel.mouseover(ag,af)}}).on("mouseout",function(ag,af){if(o.axisLabel.mouseout){o.axisLabel.mouseout(ag,af)}}).text(function(ag,af){if(B.maxValue){return b(n.correctAdd+(n.correctMul*B.maxValue*ag/n.circles.levels))+n.valUnit}});Z.exit().transition().duration(W*0.5).remove();var aa=T.selectAll("."+n.classed+"Axis").data(B.axes,q);aa.enter().append("g").attr("class",n.classed+"Axis").attr("key",function(af){return af.axis});aa.exit().transition().duration(W).style("opacity",0).remove();var X=aa.selectAll("."+n.classed+"Line").data(function(af){return[af]},q);X.enter().append("line").attr("class",n.classed+"Line").attr("x1",0).attr("y1",0).attr("x2",function(ah,ag,af){return J(null,1.1,af)}).attr("y2",function(ah,ag,af){return I(null,1.1,af)}).on("mouseover",function(ah,ag,af){if(o.line.mouseover){o.line.mouseover(ah,af)}}).on("mouseout",function(ah,ag,af){if(o.line.mouseout){o.line.mouseout(ah,af)}}).style("stroke",n.axes.lineColor).style("stroke-width","2px");X.exit().transition().duration(W*0.5).delay(function(ag,af){return 0}).remove();X.transition().duration(W).style("stroke",n.axes.lineColor).style("stroke-width",n.axes.lineWidth).attr("x2",function(ah,ag,af){return J(null,1.1,af)}).attr("y2",function(ah,ag,af){return I(null,1.1,af)});var U=aa.selectAll("."+n.classed+"AxisLegend").data(function(af){return[af]},q);U.enter().append("text").attr("class",n.classed+"AxisLegend").style("font-size",n.axes.fontWidth).attr("text-anchor","middle").attr("dy","0.35em").attr("x",function(ah,ag,af){return J(null,n.circles.labelFactor,af)}).attr("y",function(ah,ag,af){return I(null,n.circles.labelFactor,af)}).style("opacity",function(ag,af){return n.axes.display?1:0}).on("mouseover",function(ah,ag,af){if(o.axisLegend.mouseover){o.axisLegend.mouseover(ah,ag,af)}}).on("mouseout",function(ah,ag,af){if(o.axisLegend.mouseout){o.axisLegend.mouseout(ah,ag,af)}}).call(y,n.axes.wrapWidth);U.exit().transition().duration(W*0.5).delay(function(ag,af){return 0}).remove();U.transition().duration(W).style("opacity",function(ag,af){return n.axes.display&&B.radius>n.axes.threshold?1:0}).attr("x",function(ah,ag,af){return J(null,n.circles.labelFactor,af)}).attr("y",function(ah,ag,af){return I(null,n.circles.labelFactor,af)}).selectAll("tspan").attr("x",function(ah,ag,af){return J(null,n.circles.labelFactor,af)}).attr("y",function(ah,ag,af){return I(null,n.circles.labelFactor,af)});var Y=d3.svg.line.radial().interpolate(n.areas.rounded?"cardinal-closed":"linear-closed").radius(function(af){return B.rScale(af.value)}).angle(function(ag,af){return af*B.angleSlice});var ae=i.selectAll("."+n.classed+"RadarWrapper").data(G,K);ae.enter().append("g").attr("class",n.classed+"RadarWrapper").attr("key",function(af){return af.key});ae.exit().transition().duration(W).style("opacity",0).remove();ae.style("fill-opacity",function(ag,af){return n.areas.filter.indexOf(ag.key)>=0?0:n.areas.opacity});var ad=ae.selectAll("."+n.classed+"RadarArea").data(function(af){return[af]},K);ad.enter().append("path").attr("class",function(af){return n.classed+"RadarArea "+af.key.replace(/\s+/g,"")}).attr("d",function(ag,af){return Y(ag.values)}).style("fill",function(ah,ag,af){return l(ah)}).style("fill-opacity",0).on("mouseover",function(ag,af){if(o.radarArea.mouseover){o.radarArea.mouseover(ag,af,this)}}).on("mouseout",function(ag,af){if(o.radarArea.mouseout){o.radarArea.mouseout(ag,af,this)}});ad.exit().remove();ad.transition().duration(W).style("fill",function(ah,ag,af){return l(ah)}).attr("d",function(ag,af){return Y(ag.values)}).style("fill-opacity",function(ag,af){return n.areas.filter.indexOf(ag.key)>=0?0:n.areas.opacity});var ac=ae.selectAll("."+n.classed+"RadarStroke").data(function(af){return[af]},K);ac.enter().append("path").attr("class",n.classed+"RadarStroke").attr("d",function(ag,af){return Y(ag.values)}).style("opacity",0).style("stroke-width",n.areas.borderWidth+"px").style("stroke",function(ah,ag,af){return l(ah)}).style("fill","none").style("filter",function(){if(n.filter){return"url(#"+n.filter+")"}});ac.exit().remove();ac.transition().duration(W).style("stroke",function(ah,ag,af){return l(ah)}).attr("d",function(ag,af){return Y(ag.values)}).style("filter",function(){if(n.filter){return"url(#"+n.filter+")"}}).style("opacity",function(ag,af){return n.areas.filter.indexOf(ag.key)>=0?0:1});update_radarCircle=ae.selectAll("."+n.classed+"RadarCircle").data(function(ag,af){return e(ag._i,ag.key,ag.values)});update_radarCircle.enter().append("circle").attr("class",n.classed+"RadarCircle").attr("r",n.areas.dotRadius).attr("cx",function(ah,ag,af){return J(0,0,ag)}).attr("cy",function(ah,ag,af){return I(0,0,ag)}).style("fill",function(ah,ag,af){return l(ah,ah._i,G[af].key)}).style("fill-opacity",function(ag,af){return 0}).transition().duration(W).attr("cx",function(ah,ag,af){return J(ah.value,0,ag)}).attr("cy",function(ah,ag,af){return I(ah.value,0,ag)});update_radarCircle.exit().remove();update_radarCircle.transition().duration(W).style("fill",function(ah,ag,af){return l(ah,ah._i,G[af].key)}).style("fill-opacity",function(ai,ah,af){var ag=G.map(function(aj){return aj.key})[af];return n.areas.filter.indexOf(ag)>=0?0:0.8}).attr("r",n.areas.dotRadius).attr("cx",function(ag,af){return J(ag.value,0,af)}).attr("cy",function(ag,af){return I(ag.value,0,af)});var V=z.selectAll("."+n.classed+"RadarCircleWrapper").data(G,K);V.enter().append("g").attr("class",n.classed+"RadarCircleWrapper").attr("key",function(af){return af.key});V.exit().transition().duration(W).style("opacity",0).remove();update_radarInvisibleCircle=V.selectAll("."+n.classed+"RadarInvisibleCircle").data(function(ag,af){return e(ag._i,ag.key,ag.values)});update_radarInvisibleCircle.enter().append("circle").attr("class",n.classed+"RadarInvisibleCircle").attr("r",n.areas.dotRadius*1.5).attr("cx",function(ag,af){return J(ag.value,0,af)}).attr("cy",function(ag,af){return I(ag.value,0,af)}).style("fill","none").style("pointer-events","all").on("mouseover",function(ag,af){if(o.radarInvisibleCircle.mouseover){o.radarInvisibleCircle.mouseover(ag,af,this)}}).on("mouseout",function(ag,af){if(o.radarInvisibleCircle.mouseout){o.radarInvisibleCircle.mouseout(ag,af,this)}});update_radarInvisibleCircle.exit().remove();update_radarInvisibleCircle.attr("cx",function(ag,af){return J(ag.value,0,af)}).attr("cy",function(ag,af){return I(ag.value,0,af)})}})}function L(){G=JSON.parse(JSON.stringify(F));var Q=f(G);var M={};G.forEach(function(S){S.values.forEach(function(X,W){var U=M[Q[W]]?M[Q[W]]:n.axes.ranges[Q[W]]?n.axes.ranges[Q[W]].slice():[0,1];var T=X.value>U[1]?X.value:U[1];var V=X.value<U[0]?X.value:U[0];M[Q[W]]=[V,T]})});G.forEach(function(S){S.values.forEach(function(V,U){if(M[Q[U]][0]!==0&&M[Q[U]][1]!==1){var T=M[Q[U]];V.original_value=Number(V.value);V.value=(V.value-T[0])/(T[1]-T[0])}if(n.axes.invert.indexOf(Q[U])>=0){V.value=1-V.value}})});G.forEach(function(S){S._avg=d3.mean(S.values,function(T){return T.value})});G=n.areas.sort?G.sort(function(T,S){var T=T._avg;var S=S._avg;return S-T}):G;var O=Q.map(function(S,T){return(n.axes.filter.indexOf(Q[T])>=0)?T:undefined}).reverse();G.forEach(function(S){O.forEach(function(T){if(T>=0){S.values.splice(T,1)}})});var P=(function(T,S){while(T--){S[T]=T}return S})(10,[]);var R=G.map(function(S){return S._i});var N=P.filter(function(S){return R.indexOf(S)<0}).reverse();G=G.map(function(T,S){if(T._i>=0){return T}else{T._i=N.length?N.pop():S;return T}})}function f(M){return M.length?M[0].values.map(function(O,N){return O.axis}):[]}function h(){var N=G.length?G[0].values.map(function(P,O){return P}):[];var M=f(G);B={radius:Math.min((n.width-(n.margins.left+n.margins.right))/2,(n.height-(n.margins.bottom+n.margins.top))/2),axes:N,axisLabels:M,maxValue:Math.max(n.circles.maxValue,d3.max(G,function(O){return d3.max(O.values.map(function(P){return P.value}))}))};B.radius=Math.max(B.radius,n.minRadius);B.total=B.axes.length;B.angleSlice=B.total>0?Math.PI*2/B.total:1;B.rScale=d3.scale.linear().range([0,B.radius]).domain([0,B.maxValue])}function A(R,O,Q){if(O.constructor===Array){O.forEach(function(T){N(T)})}else{if(typeof O!="object"){N(O)}else{return H}}function N(T){if(!isNaN(T)&&(function(U){return(U|0)===U})(parseFloat(T))){P(parseInt(T))}else{if(typeof T=="string"){P(T)}}}function P(T){if(Q.indexOf(T)>=0){S(T)}else{if(T>=0&&T<Q.length){S(Q[T])}}}function S(T){if(R.indexOf(T)>=0){M(R,T)}else{R.push(T)}}function M(T,V){for(var U=T.length;U--;){if(T[U]===V){T.splice(U,1)}}}}function J(N,O,M){return B.rScale(N?N:B.maxValue*O)*Math.cos(B.angleSlice*M-Math.PI/2)}function I(N,O,M){return B.rScale(N?N:B.maxValue*O)*Math.sin(B.angleSlice*M-Math.PI/2)}function l(O,M,N){M=M?M:O._i;N=N?N:O.key;return n.areas.colors[N]?n.areas.colors[N]:n.color[M]}H.nodes=function(){return{svg:svg,chart:i,hover:z,tooltip:x}};H.events=function(O){if(!arguments.length){return o}var P=Object.keys(O);var N=Object.keys(o);for(var M=0;M<P.length;M++){if(N.indexOf(P[M])>=0){o[P[M]]=O[P[M]]}}return H};H.width=function(M){if(!arguments.length){return n.width}if(n.resize){n.widthMax=M}else{n.width=M}u();return H};H.height=function(M){if(!arguments.length){return n.height}if(n.resize){n.heightMax=M}else{n.height=M}u();return H};H.duration=function(M){if(!arguments.length){return E}E=M;return H};H.update=function(){if(o.update.begin){o.update.begin(G)}if(typeof r==="function"){r()}setTimeout(function(){if(o.update.end){o.update.end(G)}},E)};H.data=function(N){if(!arguments.length){return F}if(c.length){var M=G.map(function(O){return O.key});c.forEach(function(P,O){H.filterAreas(M[O])})}c=[];F=N;return H};H.pop=function(){var M=F.pop();if(typeof r==="function"){r()}return M};H.push=function(O){if(O&&O.constructor===Array){for(var N=0;N<O.length;N++){M(O[N])}}else{M(O)}function M(P){if(P.key&&F.map(function(Q){return Q.key}).indexOf(P.key)<0){F.push(P)}}return H};H.shift=function(){var M=F.shift();if(typeof r==="function"){r()}return M};H.unshift=function(O){if(O&&O.constructor===Array){for(var N=0;N<O.length;N++){M(O[N])}}else{M(O)}function M(P){if(P.key&&F.map(function(Q){return Q.key}).indexOf(P.key)<0){F.unshift(P)}}return H};H.slice=function(N,M){return F.slice(N,M)};H.options=function(Q){if(!arguments.length){return n}var R=Object.keys(Q);var S=Object.keys(n);for(var P=0;P<R.length;P++){if(S.indexOf(R[P])>=0){if(typeof(n[R[P]])=="object"){var M=Object.keys(Q[R[P]]);var O=Object.keys(n[R[P]]);for(var N=0;N<M.length;N++){if(O.indexOf(M[N])>=0){n[R[P]][M[N]]=Q[R[P]][M[N]]}}}else{n[R[P]]=Q[R[P]]}}}return H};H.margins=function(O){if(!arguments.length){return n.margins}var N=Object.keys(values);var P=Object.keys(n.margins);for(var M=0;M<N.length;M++){if(P.indexOf(N[M])>=0){n.margins[N[M]]=values[N[M]]}}return H};H.levels=function(M){if(!arguments.length){return n.circles.levels}n.circles.levels=M;return H};H.maxValue=function(M){if(!arguments.length){return n.circles.maxValue}n.circles.maxValue=M;return H};H.opacity=function(M){if(!arguments.length){return n.areas.opacity}n.areas.opacity=M;return H};H.borderWidth=function(M){if(!arguments.length){return n.areas.borderWidth}n.areas.borderWidth=M;return H};H.rounded=function(M){if(!arguments.length){return n.areas.rounded}n.areas.rounded=M;return H};H.color=function(M){if(!arguments.length){return n.color}n.color=M;return H};H.colors=function(M){if(!arguments.length){return n.areas.colors}n.areas.colors=M;return H};H.keys=function(){return F.map(function(M){return M.key})};H.axes=function(){return f(F)};H.filterAxes=function(M){if(!arguments.length){return n.axes.filter}var N=f(F);A(n.axes.filter,M,N);return H};H.filterAreas=function(M){if(!arguments.length){return n.areas.filter}var N=F.map(function(O){return O.key});A(n.areas.filter,M,N);return H};H.invert=function(M){if(!arguments.length){return n.axes.invert}var N=f(F);A(n.axes.invert,M,N);return H};H.ranges=function(N){if(!arguments.length){return n.axes.ranges}if(typeof N=="string"){return H}var P=f(F);if(N&&N.constructor===Array){N.forEach(function(Q){M(Q)})}else{M(N)}function M(S){var R=Object.keys(S);for(var Q=0;Q<R.length;Q++){if(P.indexOf(R[Q])>=0&&S[R[Q]]&&S[R[Q]].constructor===Array&&O(R[Q],S[R[Q]])){n.axes.ranges[R[Q]]=S[R[Q]]}}}function O(R,Q){if(Q.length==2&&!isNaN(Q[0])&&!isNaN(Q[1])){return true}else{if(Q.length==0){delete n.axes.ranges[R]}}return false}return H};function D(O,N,M){if(c[O._i]){return}i.selectAll("."+n.classed+"RadarArea").transition().duration(200).style("fill-opacity",function(R,Q,P){return n.areas.filter.indexOf(R.key)>=0?0:0.1});d3.select(M).transition().duration(200).style("fill-opacity",function(R,Q,P){return n.areas.filter.indexOf(R.key)>=0?0:0.7});C(O,N,M)}function v(O,N,M){i.selectAll("."+n.classed+"RadarArea").transition().duration(200).style("fill-opacity",function(R,Q,P){return n.areas.filter.indexOf(R.key)>=0?0:n.areas.opacity});a(O,N,M)}function k(P,N,M){if(c[P]){return}var O=p.indexOf(P)>=0?P:m(P);i.selectAll("."+n.classed+"RadarArea").transition().duration(200).style("fill-opacity",function(S,R,Q){return n.areas.filter.indexOf(S.key)>=0?0:0.1});i.selectAll("."+n.classed+"RadarArea."+O.replace(/\s+/g,"")).transition().duration(200).style("fill-opacity",function(S,R,Q){return n.areas.filter.indexOf(S.key)>=0?0:0.7})}function j(P,N,M){var O=G.map(function(Q){return Q.key});A(n.areas.filter,O[P],O);c[P]=c[P]?false:true;r()}function C(P,N,M){if(c[P._i]){return}if(n.width>200){var O=P.key.replace(/ - /gi,"<br/>");t.html(O).transition().duration(200).style("opacity","1")}}function a(O,N,M){t.transition().duration(200).style("opacity","0")}function e(O,P,N){for(var M=0;M<N.length;M++){N[M]["_i"]=O;N[M]["key"]=P}return N}var K=function(M){return M&&M.key};var q=function(M){return M&&M.axis};function y(N,M){N.each(function(S,R,Q){var Y=d3.select(this);var T=S.axis.split(/\s+/).reverse();var O;var aa=[];var P=0;var X=1.4;var W=J(null,n.circles.labelFactor,Q);var V=I(null,n.circles.labelFactor,Q);var Z=parseFloat(Y.attr("dy"));var U=Y.text(null).append("tspan").attr("dy",Z+"em");while(O=T.pop()){aa.push(O);U.text(aa.join(" "));if(U.node().getComputedTextLength()>M){aa.pop();U.text(aa.join(" "));aa=[O];U=Y.append("tspan").attr("dy",++P*X+Z+"em").text(O)}}})}window.addEventListener("resize",u,false);function u(){if(!n.resize||!d){return}var N=d.node().getBoundingClientRect().left;var P=d.node().getBoundingClientRect().top;var O=Math.min(n.widthMax,document.documentElement.clientWidth-N);var M=Math.min(n.heightMax,document.documentElement.clientHeight-P);n.height=M;n.width=O;H.update()}return H}var UUID=(function(){var a={};var c=[];for(var b=0;b<256;b++){c[b]=(b<16?"0":"")+(b).toString(16)}a.generate=function(){var g=Math.random()*4294967295|0;var f=Math.random()*4294967295|0;var e=Math.random()*4294967295|0;var d=Math.random()*4294967295|0;return c[g&255]+c[g>>8&255]+c[g>>16&255]+c[g>>24&255]+"-"+c[f&255]+c[f>>8&255]+"-"+c[f>>16&15|64]+c[f>>24&255]+"-"+c[e&63|128]+c[e>>8&255]+"-"+c[e>>16&255]+c[e>>24&255]+c[d&255]+c[d>>8&255]+c[d>>16&255]+c[d>>24&255]};return a})();