function RadarChart(){var z=UUID.generate();var H=[];var k={filter:"rcGlow"+z,filter_id:"rcGlow"+z,resize:false,valFormat:"",valUnit:"",width:window.innerWidth,widthMax:window.innerWidth,height:window.innerHeight,heightMax:window.innerHeight,correctAdd:0,correctMul:1,minRadius:80,margins:{top:0,right:0,bottom:0,left:0},circles:{levels:6,maxValue:0,labelFactor:1.25,opacity:0.1,fill:"#CDCDCD",color:"#CDCDCD"},areas:{colors:{},opacity:0.35,borderWidth:2,rounded:false,dotRadius:4,sort:true,filter:[]},axes:{display:true,threshold:90,lineColor:"white",lineWidth:"2px",fontWidth:"11px",fontColor:"black",wrapWidth:60,filter:[],invert:[],ranges:{}},classed:"lws",color:d3.scale.category10().range()};var i;var y;var l;var f={update:{begin:null,end:null},gridCircle:{mouseover:null,mouseout:null,mouseclick:null},axisLabel:{mouseover:null,mouseout:null,mouseclick:null},line:{mouseover:null,mouseout:null,mouseclick:null},axisLegend:{mouseover:null,mouseout:null,mouseclick:null},radarArea:{mouseover:b,mouseout:t,mouseclick:null},radarInvisibleCircle:{mouseover:r,mouseout:G,mouseclick:null}};var p;var m;var x=[];var A={};var n=d3.format(k.valFormat);var d=0;var F=0;var v;var c;var D;var u;function w(J){J.each(function(){j();B();u=d3.select(this);C();var K=u.append("svg").attr("overflow","visible").attr("width",k.width).attr("height",k.height);i=K.append("g").attr("class",k.classed+"RadarNode");y=K.append("g").attr("class",k.classed+"HoverNode");l=K.append("foreignObject").attr("class",k.classed+"TooltipNode");var Q=i.append("g").attr("class",k.classed+"AxisWrapper");var M=i.append("defs").append("filter").attr("id",k.filter_id),P=M.append("feGaussianBlur").attr("stdDeviation","2.5").attr("result","coloredBlur"),O=M.append("feMerge"),N=O.append("feMergeNode").attr("in","coloredBlur"),L=O.append("feMergeNode").attr("in","SourceGraphic");m=l.append("xhtml:div").style("opacity","0.00001").style("text-align","left").style("float","left");p=function(){var T=d;var Y=10-k.margins.top;if(k.width>400){Y=20-k.margins.top}n=d3.format(k.valFormat);j();B();v=x.map(function(ad){return ad.key});c=d3.scale.ordinal().domain(x.map(function(ad){return ad._i})).range(x.map(function(ad){return ad.key}));D=d3.scale.ordinal().domain(x.map(function(ad){return k.areas.colors[c(ad._i)]?c(ad._i):ad._i.toString()})).range(x.map(function(ad){return h(ad)}));K.transition().delay(F).duration(T).attr("width",k.width).attr("height",k.height);i.transition().delay(F).duration(T).attr("width",k.width).attr("height",k.height).attr("transform","translate("+((k.width-(k.margins.left+k.margins.right))/2+k.margins.left)+","+((k.height-(k.margins.top+k.margins.bottom))/2+k.margins.top)+")");y.transition().delay(F).duration(T).attr("width",k.width).attr("height",k.height).attr("transform","translate("+((k.width-(k.margins.left+k.margins.right))/2+k.margins.left)+","+((k.height-(k.margins.top+k.margins.bottom))/2+k.margins.top)+")");l.transition().delay(F).duration(T).attr("width",k.width/2).attr("height",k.height/4).attr("transform","translate("+Y+",0)");m.transition().delay(F).duration(T).attr("width",k.width/2).attr("height",k.height/4);var Z=Q.selectAll("."+k.classed+"GridCircle").data(d3.range(1,(k.circles.levels+1)).reverse());Z.transition().duration(T).attr("r",function(ae,ad){return A.radius/k.circles.levels*ae}).style("fill",k.circles.fill).style("fill-opacity",k.circles.opacity).style("stroke",k.circles.color).style("filter",function(){if(k.filter){return"url(#"+k.filter+")"}});Z.enter().append("circle").attr("class",k.classed+"GridCircle").attr("r",function(ae,ad){return A.radius/k.circles.levels*ae}).on("mouseover",function(ae,ad){if(f.gridCircle.mouseover){f.gridCircle.mouseover(ae,ad)}}).on("mouseout",function(ae,ad){if(f.gridCircle.mouseout){f.gridCircle.mouseout(ae,ad)}}).style("fill",k.circles.fill).style("fill-opacity",k.circles.opacity).style("stroke",k.circles.color).style("filter",function(){if(k.filter){return"url(#"+k.filter+")"}});Z.exit().transition().duration(T*0.5).delay(function(ae,ad){return 0}).remove();var W=Q.selectAll("."+k.classed+"AxisLabel").data(d3.range(1,(k.circles.levels+1)).reverse());W.transition().duration(T/2).style("opacity",1).transition().duration(T/2).text(function(ae,ad){if(A.maxValue){return n(k.correctAdd+(k.correctMul*A.maxValue*ae/k.circles.levels))+k.valUnit}}).attr("y",function(ad){return -ad*A.radius/k.circles.levels}).style("opacity",1);W.enter().append("text").attr("class",k.classed+"AxisLabel").attr("x",4).attr("y",function(ad){return -ad*A.radius/k.circles.levels}).attr("dy","0.4em").style("font-size","10px").attr("fill","#737373").on("mouseover",function(ae,ad){if(f.axisLabel.mouseover){f.axisLabel.mouseover(ae,ad)}}).on("mouseout",function(ae,ad){if(f.axisLabel.mouseout){f.axisLabel.mouseout(ae,ad)}}).text(function(ae,ad){if(A.maxValue){return n(k.correctAdd+(k.correctMul*A.maxValue*ae/k.circles.levels))+k.valUnit}});W.exit().transition().duration(T*0.5).remove();var X=Q.selectAll("."+k.classed+"Axis").data(A.axes,E);X.enter().append("g").attr("class",k.classed+"Axis").attr("key",function(ad){return ad.axis});X.exit().transition().duration(T).style("opacity",0).remove();var U=X.selectAll("."+k.classed+"Line").data(function(ad){return[ad]},E);U.enter().append("line").attr("class",k.classed+"Line").attr("x1",0).attr("y1",0).attr("x2",function(af,ae,ad){return g(null,1.1,ad)}).attr("y2",function(af,ae,ad){return e(null,1.1,ad)}).on("mouseover",function(af,ae,ad){if(f.line.mouseover){f.line.mouseover(af,ad)}}).on("mouseout",function(af,ae,ad){if(f.line.mouseout){f.line.mouseout(af,ad)}}).style("stroke",k.axes.lineColor).style("stroke-width","2px");U.exit().transition().duration(T*0.5).delay(function(ae,ad){return 0}).remove();U.transition().duration(T).style("stroke",k.axes.lineColor).style("stroke-width",k.axes.lineWidth).attr("x2",function(af,ae,ad){return g(null,1.1,ad)}).attr("y2",function(af,ae,ad){return e(null,1.1,ad)});var R=X.selectAll("."+k.classed+"AxisLegend").data(function(ad){return[ad]},E);R.enter().append("text").attr("class",k.classed+"AxisLegend").style("font-size",k.axes.fontWidth).attr("text-anchor","middle").attr("dy","0.35em").attr("x",function(af,ae,ad){return g(null,k.circles.labelFactor,ad)}).attr("y",function(af,ae,ad){return e(null,k.circles.labelFactor,ad)}).style("opacity",function(ae,ad){return k.axes.display?1:0}).on("mouseover",function(af,ae,ad){if(f.axisLegend.mouseover){f.axisLegend.mouseover(af,ae,ad)}}).on("mouseout",function(af,ae,ad){if(f.axisLegend.mouseout){f.axisLegend.mouseout(af,ae,ad)}}).call(q,k.axes.wrapWidth);R.exit().transition().duration(T*0.5).delay(function(ae,ad){return 0}).remove();R.transition().duration(T).style("opacity",function(ae,ad){return k.axes.display&&A.radius>k.axes.threshold?1:0}).attr("x",function(af,ae,ad){return g(null,k.circles.labelFactor,ad)}).attr("y",function(af,ae,ad){return e(null,k.circles.labelFactor,ad)}).selectAll("tspan").attr("x",function(af,ae,ad){return g(null,k.circles.labelFactor,ad)}).attr("y",function(af,ae,ad){return e(null,k.circles.labelFactor,ad)});var V=d3.svg.line.radial().interpolate(k.areas.rounded?"cardinal-closed":"linear-closed").radius(function(ad){return A.rScale(ad.value)}).angle(function(ae,ad){return ad*A.angleSlice});var ac=i.selectAll("."+k.classed+"RadarWrapper").data(x,s);ac.enter().append("g").attr("class",k.classed+"RadarWrapper").attr("key",function(ad){return ad.key});ac.exit().transition().duration(T).style("opacity",0).remove();ac.style("fill-opacity",function(ae,ad){return k.areas.filter.indexOf(ae.key)>=0?0:k.areas.opacity});var ab=ac.selectAll("."+k.classed+"RadarArea").data(function(ad){return[ad]},s);ab.enter().append("path").attr("class",function(ad){return k.classed+"RadarArea "+ad.key.replace(/\s+/g,"")}).attr("d",function(ae,ad){return V(ae.values)}).style("fill",function(af,ae,ad){return h(af)}).style("fill-opacity",0).on("mouseover",function(ae,ad){if(f.radarArea.mouseover){f.radarArea.mouseover(ae,ad,this)}}).on("mouseout",function(ae,ad){if(f.radarArea.mouseout){f.radarArea.mouseout(ae,ad,this)}});ab.exit().remove();ab.transition().duration(T).style("fill",function(af,ae,ad){return h(af)}).attr("d",function(ae,ad){return V(ae.values)}).style("fill-opacity",function(ae,ad){return k.areas.filter.indexOf(ae.key)>=0?0:k.areas.opacity});var aa=ac.selectAll("."+k.classed+"RadarStroke").data(function(ad){return[ad]},s);aa.enter().append("path").attr("class",k.classed+"RadarStroke").attr("d",function(ae,ad){return V(ae.values)}).style("opacity",0).style("stroke-width",k.areas.borderWidth+"px").style("stroke",function(af,ae,ad){return h(af)}).style("fill","none").style("filter",function(){if(k.filter){return"url(#"+k.filter+")"}});aa.exit().remove();aa.transition().duration(T).style("stroke",function(af,ae,ad){return h(af)}).attr("d",function(ae,ad){return V(ae.values)}).style("filter",function(){if(k.filter){return"url(#"+k.filter+")"}}).style("opacity",function(ae,ad){return k.areas.filter.indexOf(ae.key)>=0?0:1});update_radarCircle=ac.selectAll("."+k.classed+"RadarCircle").data(function(ae,ad){return a(ae._i,ae.key,ae.values)});update_radarCircle.enter().append("circle").attr("class",k.classed+"RadarCircle").attr("r",k.areas.dotRadius).attr("cx",function(af,ae,ad){return g(0,0,ae)}).attr("cy",function(af,ae,ad){return e(0,0,ae)}).style("fill",function(af,ae,ad){return h(af,af._i,x[ad].key)}).style("fill-opacity",function(ae,ad){return 0}).transition().duration(T).attr("cx",function(af,ae,ad){return g(af.value,0,ae)}).attr("cy",function(af,ae,ad){return e(af.value,0,ae)});update_radarCircle.exit().remove();update_radarCircle.transition().duration(T).style("fill",function(af,ae,ad){return h(af,af._i,x[ad].key)}).style("fill-opacity",function(ag,af,ad){var ae=x.map(function(ah){return ah.key})[ad];return k.areas.filter.indexOf(ae)>=0?0:0.8}).attr("r",k.areas.dotRadius).attr("cx",function(ae,ad){return g(ae.value,0,ad)}).attr("cy",function(ae,ad){return e(ae.value,0,ad)});var S=y.selectAll("."+k.classed+"RadarCircleWrapper").data(x,s);S.enter().append("g").attr("class",k.classed+"RadarCircleWrapper").attr("key",function(ad){return ad.key});S.exit().transition().duration(T).style("opacity",0).remove();update_radarInvisibleCircle=S.selectAll("."+k.classed+"RadarInvisibleCircle").data(function(ae,ad){return a(ae._i,ae.key,ae.values)});update_radarInvisibleCircle.enter().append("circle").attr("class",k.classed+"RadarInvisibleCircle").attr("r",k.areas.dotRadius*1.5).attr("cx",function(ae,ad){return g(ae.value,0,ad)}).attr("cy",function(ae,ad){return e(ae.value,0,ad)}).style("fill","none").style("pointer-events","all").on("mouseover",function(ae,ad){if(f.radarInvisibleCircle.mouseover){f.radarInvisibleCircle.mouseover(ae,ad,this)}}).on("mouseout",function(ae,ad){if(f.radarInvisibleCircle.mouseout){f.radarInvisibleCircle.mouseout(ae,ad,this)}});update_radarInvisibleCircle.exit().remove();update_radarInvisibleCircle.attr("cx",function(ae,ad){return g(ae.value,0,ad)}).attr("cy",function(ae,ad){return e(ae.value,0,ad)})}})}function j(){x=JSON.parse(JSON.stringify(H));var N=I(x);var J={};x.forEach(function(P){P.values.forEach(function(U,T){var R=J[N[T]]?J[N[T]]:k.axes.ranges[N[T]]?k.axes.ranges[N[T]].slice():[0,1];var Q=U.value>R[1]?U.value:R[1];var S=U.value<R[0]?U.value:R[0];J[N[T]]=[S,Q]})});x.forEach(function(P){P.values.forEach(function(S,R){if(J[N[R]][0]!==0&&J[N[R]][1]!==1){var Q=J[N[R]];S.original_value=Number(S.value);S.value=(S.value-Q[0])/(Q[1]-Q[0])}if(k.axes.invert.indexOf(N[R])>=0){S.value=1-S.value}})});x.forEach(function(P){P._avg=d3.mean(P.values,function(Q){return Q.value})});x=k.areas.sort?x.sort(function(Q,P){var Q=Q._avg;var P=P._avg;return P-Q}):x;var L=N.map(function(P,Q){return(k.axes.filter.indexOf(N[Q])>=0)?Q:undefined}).reverse();x.forEach(function(P){L.forEach(function(Q){if(Q>=0){P.values.splice(Q,1)}})});var M=(function(Q,P){while(Q--){P[Q]=Q}return P})(10,[]);var O=x.map(function(P){return P._i});var K=M.filter(function(P){return O.indexOf(P)<0}).reverse();x=x.map(function(Q,P){if(Q._i>=0){return Q}else{Q._i=K.length?K.pop():P;return Q}})}function I(J){return J.length?J[0].values.map(function(L,K){return L.axis}):[]}function B(){var K=x.length?x[0].values.map(function(M,L){return M}):[];var J=I(x);A={radius:Math.min((k.width-(k.margins.left+k.margins.right))/2,(k.height-(k.margins.bottom+k.margins.top))/2),axes:K,axisLabels:J,maxValue:Math.max(k.circles.maxValue,d3.max(x,function(L){return d3.max(L.values.map(function(M){return M.value}))}))};A.radius=Math.max(A.radius,k.minRadius);A.total=A.axes.length;A.angleSlice=A.total>0?Math.PI*2/A.total:1;A.rScale=d3.scale.linear().range([0,A.radius]).domain([0,A.maxValue])}function o(O,L,N){if(L.constructor===Array){L.forEach(function(Q){K(Q)})}else{if(typeof L!="object"){K(L)}else{return w}}function K(Q){if(!isNaN(Q)&&(function(R){return(R|0)===R})(parseFloat(Q))){M(parseInt(Q))}else{if(typeof Q=="string"){M(Q)}}}function M(Q){if(N.indexOf(Q)>=0){P(Q)}else{if(Q>=0&&Q<N.length){P(N[Q])}}}function P(Q){if(O.indexOf(Q)>=0){J(O,Q)}else{O.push(Q)}}function J(Q,S){for(var R=Q.length;R--;){if(Q[R]===S){Q.splice(R,1)}}}}function g(K,L,J){return A.rScale(K?K:A.maxValue*L)*Math.cos(A.angleSlice*J-Math.PI/2)}function e(K,L,J){return A.rScale(K?K:A.maxValue*L)*Math.sin(A.angleSlice*J-Math.PI/2)}function h(L,J,K){J=J?J:L._i;K=K?K:L.key;return k.areas.colors[K]?k.areas.colors[K]:k.color[J]}w.nodes=function(){return{svg:svg,chart:i,hover:y,tooltip:l}};w.events=function(L){if(!arguments.length){return f}var M=Object.keys(L);var K=Object.keys(f);for(var J=0;J<M.length;J++){if(K.indexOf(M[J])>=0){f[M[J]]=L[M[J]]}}return w};w.width=function(J){if(!arguments.length){return k.width}if(k.resize){k.widthMax=J}else{k.width=J}C();return w};w.height=function(J){if(!arguments.length){return k.height}if(k.resize){k.heightMax=J}else{k.height=J}C();return w};w.duration=function(J){if(!arguments.length){return d}d=J;return w};w.update=function(){if(f.update.begin){f.update.begin(x)}if(typeof p==="function"){p()}setTimeout(function(){if(f.update.end){f.update.end(x)}},d)};w.data=function(J){if(!arguments.length){return H}H=J;return w};w.pop=function(){var J=H.pop();if(typeof p==="function"){p()}return J};w.push=function(L){if(L&&L.constructor===Array){for(var K=0;K<L.length;K++){J(L[K])}}else{J(L)}function J(M){if(M.key&&H.map(function(N){return N.key}).indexOf(M.key)<0){H.push(M)}}return w};w.shift=function(){var J=H.shift();if(typeof p==="function"){p()}return J};w.unshift=function(L){if(L&&L.constructor===Array){for(var K=0;K<L.length;K++){J(L[K])}}else{J(L)}function J(M){if(M.key&&H.map(function(N){return N.key}).indexOf(M.key)<0){H.unshift(M)}}return w};w.slice=function(K,J){return H.slice(K,J)};w.options=function(N){if(!arguments.length){return k}var O=Object.keys(N);var P=Object.keys(k);for(var M=0;M<O.length;M++){if(P.indexOf(O[M])>=0){if(typeof(k[O[M]])=="object"){var J=Object.keys(N[O[M]]);var L=Object.keys(k[O[M]]);for(var K=0;K<J.length;K++){if(L.indexOf(J[K])>=0){k[O[M]][J[K]]=N[O[M]][J[K]]}}}else{k[O[M]]=N[O[M]]}}}return w};w.margins=function(L){if(!arguments.length){return k.margins}var K=Object.keys(values);var M=Object.keys(k.margins);for(var J=0;J<K.length;J++){if(M.indexOf(K[J])>=0){k.margins[K[J]]=values[K[J]]}}return w};w.levels=function(J){if(!arguments.length){return k.circles.levels}k.circles.levels=J;return w};w.maxValue=function(J){if(!arguments.length){return k.circles.maxValue}k.circles.maxValue=J;return w};w.opacity=function(J){if(!arguments.length){return k.areas.opacity}k.areas.opacity=J;return w};w.borderWidth=function(J){if(!arguments.length){return k.areas.borderWidth}k.areas.borderWidth=J;return w};w.rounded=function(J){if(!arguments.length){return k.areas.rounded}k.areas.rounded=J;return w};w.color=function(J){if(!arguments.length){return k.color}k.color=J;return w};w.colors=function(J){if(!arguments.length){return k.areas.colors}k.areas.colors=J;return w};w.keys=function(){return H.map(function(J){return J.key})};w.axes=function(){return I(H)};w.filterAxes=function(J){if(!arguments.length){return k.axes.filter}var K=I(H);o(k.axes.filter,J,K);return w};w.filterAreas=function(J){if(!arguments.length){return k.areas.filter}var K=H.map(function(L){return L.key});o(k.areas.filter,J,K);return w};w.invert=function(J){if(!arguments.length){return k.axes.invert}var K=I(H);o(k.axes.invert,J,K);return w};w.ranges=function(K){if(!arguments.length){return k.axes.ranges}if(typeof K=="string"){return w}var M=I(H);if(K&&K.constructor===Array){K.forEach(function(N){J(N)})}else{J(K)}function J(P){var O=Object.keys(P);for(var N=0;N<O.length;N++){if(M.indexOf(O[N])>=0&&P[O[N]]&&P[O[N]].constructor===Array&&L(O[N],P[O[N]])){k.axes.ranges[O[N]]=P[O[N]]}}}function L(O,N){if(N.length==2&&!isNaN(N[0])&&!isNaN(N[1])){return true}else{if(N.length==0){delete k.axes.ranges[O]}}return false}return w};function b(L,K,J){i.selectAll("."+k.classed+"RadarArea").style("fill-opacity",function(O,N,M){return k.areas.filter.indexOf(O.key)>=0?0:0.1});d3.select(J).style("fill-opacity",function(O,N,M){return k.areas.filter.indexOf(O.key)>=0?0:0.7});r(L,K,J)}function t(L,K,J){i.selectAll("."+k.classed+"RadarArea").style("fill-opacity",function(O,N,M){return k.areas.filter.indexOf(O.key)>=0?0:k.areas.opacity});G(L,K,J)}function r(M,K,J){if(k.width>200){var L=M.key.replace(/ - /gi,"<br/>");m.html(L).style("opacity","1")}}function G(L,K,J){m.style("opacity","0.00001")}function a(L,M,K){for(var J=0;J<K.length;J++){K[J]["_i"]=L;K[J]["key"]=M}return K}var s=function(J){return J&&J.key};var E=function(J){return J&&J.axis};function q(K,J){K.each(function(P,O,N){var V=d3.select(this);var Q=P.axis.split(/\s+/).reverse();var L;var X=[];var M=0;var U=1.4;var T=g(null,k.circles.labelFactor,N);var S=e(null,k.circles.labelFactor,N);var W=parseFloat(V.attr("dy"));var R=V.text(null).append("tspan").attr("dy",W+"em");while(L=Q.pop()){X.push(L);R.text(X.join(" "));if(R.node().getComputedTextLength()>J){X.pop();R.text(X.join(" "));X=[L];R=V.append("tspan").attr("dy",++M*U+W+"em").text(L)}}})}window.addEventListener("resize",C,false);function C(){if(!k.resize||!u){return}var K=u.node().getBoundingClientRect().left;var M=u.node().getBoundingClientRect().top;var L=Math.min(k.widthMax,document.documentElement.clientWidth-K);var J=Math.min(k.heightMax,document.documentElement.clientHeight-M);k.height=J;k.width=L;w.update()}return w}var UUID=(function(){var a={};var c=[];for(var b=0;b<256;b++){c[b]=(b<16?"0":"")+(b).toString(16)}a.generate=function(){var g=Math.random()*4294967295|0;var f=Math.random()*4294967295|0;var e=Math.random()*4294967295|0;var d=Math.random()*4294967295|0;return c[g&255]+c[g>>8&255]+c[g>>16&255]+c[g>>24&255]+"-"+c[f&255]+c[f>>8&255]+"-"+c[f>>16&15|64]+c[f>>24&255]+"-"+c[e&63|128]+c[e>>8&255]+"-"+c[e>>16&255]+c[e>>24&255]+c[d&255]+c[d>>8&255]+c[d>>16&255]+c[d>>24&255]};return a})();